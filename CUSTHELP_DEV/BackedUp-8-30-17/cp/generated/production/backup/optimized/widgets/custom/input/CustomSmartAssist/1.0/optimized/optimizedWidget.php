<? namespace Custom\Widgets\input;
class CustomSmartAssist extends \RightNow\Widgets\SmartAssistantDialog {
function _custom_input_CustomSmartAssist_view ($data) {
extract($data);
?><?php ?>
<div id="rn_<?=$this->instanceID;?>" class="<?=
$this->classList ?> rn_Hidden">
    <div class="rn_MessageBox rn_InfoMessage">
        <span id="rn_<?=$this->instanceID;?>_DialogHeading" class="rn_Heading"><??></span>
    </div>
    <div id="rn_<?=$this->instanceID;?>_DialogContent" role="document"><?
?></div>
</div>
<? }
function getData() {
$defaultButtons = array('label_solved_button', 'label_submit_button', 'label_cancel_button');
$cleanUpValue = function($value) {
return strtolower(trim($value));
};
$buttons = array_map($cleanUpValue, array_unique(explode(',', $this->data['attrs']['button_ordering'])));
$displayAsLinks = array_map($cleanUpValue, array_unique(explode(',', $this->data['attrs']['display_button_as_link'])));
$ordering = array();
for($i = 0;
$i < count($buttons);
$i++) {
if(($button = $buttons[$i]) && in_array($button, $defaultButtons) && $this->data['attrs'][$button]) {
unset($defaultButtons[array_search($button, $defaultButtons, true)]);
$this->pushItem($ordering, $button, in_array($button, $displayAsLinks));
}
}
$i = 0;
while(count($ordering) < count($defaultButtons) && $i < count($defaultButtons)) {
$default = $defaultButtons[$i];
if(!array_key_exists($default, $ordering) && $this->data['attrs'][$default]) {
$this->pushItem($ordering, $default, in_array($default, $displayAsLinks));
}
$i++;
}
$this->data['attrs']['button_ordering'] = $ordering;
}
protected function pushItem(array &$orderingArray, $attributeName, $displayAsLink) {
$orderingArray[] = array( 'name' => $attributeName, 'label' => $this->data['attrs'][$attributeName], 'displayAsLink' => $displayAsLink, );
}
}
function _custom_input_CustomSmartAssist_header() {
$result = array( 'js_name' => 'Custom.Widgets.input.CustomSmartAssist', 'library_name' => 'CustomSmartAssist', 'view_func_name' => '_custom_input_CustomSmartAssist_view', 'meta' => array ( 'controller_path' => 'custom/input/CustomSmartAssist', 'view_path' => 'custom/input/CustomSmartAssist', 'js_path' => 'custom/input/CustomSmartAssist', 'base_css' => array ( 0 => 'custom/input/CustomSmartAssist/base.css', ), 'js_templates' => array ( 'answerContent' => '<span id="<%= spanID %>" class="rn_Answer rn_AnswerDetail rn_Hidden"> <% if(question) { %> <span class="rn_AnswerSummary"><%= question %></span> <% } %> <span class="rn_AnswerSolution"><%= contents %></span></span>', 'answerLink' => '<a target="_blank" href="<%= href %>" onclick=\'RightNow.ActionCapture.record("smartAssistantResult", "view", <%= answerID %>);\'> <%= text %></a>', 'customDisplayResults' => '<% for(var i = 0, suggestion; i < suggestions.length; i++) { suggestion = suggestions[i]; if(suggestion.type === \'AnswerSummary\') { %>  <div class="rn_Prompt"><%= attrs.label_prompt %> <% if(attrs.accesskeys_enabled && attrs.label_accesskey && attrs.display_answers_inline) { %> <div class="rn_AccesskeyPrompt"><%= accessKeyPrompt %></div> <% } %> </div>  <ul class="rn_List <%= (attrs.display_answers_inline) ? \'rn_InlineAnswers\' : \'\' %>"> <% for(var j = 0; j < suggestion.list.length; j++) { %> <% if(attrs.display_answers_inline) { %>  <li> <% if(attrs.accesskeys_enabled) { %>  <a aria-expanded="false" href="javascript:void(0)" accesskey="<%=j+1%>" data-id="<%=suggestion.list[j].ID%>" class="rn_InlineAnswerLink rn_ExpandAnswer" id="<%=baseDomID + \'_Answer\' + suggestion.list[j].ID %>"> <% } else { %>  <a aria-expanded="false" href="javascript:void(0)" data-id="<%=suggestion.list[j].ID%>" class="rn_InlineAnswerLink rn_ExpandAnswer" id="<%=baseDomID + \'_Answer\' + suggestion.list[j].ID %>"> <% } %> <%= suggestion.list[j].title %> <span class="rn_ScreenReaderOnly" role="alert" id="<%=baseDomID + \'_Answer\' + suggestion.list[j].ID + \'_Alternative\'%>"> <%= attrs.label_collapsed %> </span> </a>  </li>  <% } else { %>  <li>  <a target="_blank" href="<%= \'/app/\' + answerUrl + \'/a_id/\' + suggestion.list[j].ID + sessionParam %>" onclick=\'RightNow.ActionCapture.record("smartAssistantResult", "view", <%=suggestion.list[j].ID%>);\'> <%=suggestion.list[j].title%> </a>  </li>  <% } %> <% } %> </ul> <% } else if(suggestion.type === \'Answer\') { %>  <div class="rn_Answer"> <div class="rn_Summary"><%=suggestion.title%></div> <div class="rn_Solution"><%=suggestion.content%></div> </div>  <% } else { %>  <div class="rn_Response"><%=suggestion.content%></div>  <% } %><% } %>', ), 'template_path' => 'custom/input/CustomSmartAssist', 'version' => '1.0', 'requires' => array ( 'jsModule' => array ( 0 => 'standard', 1 => 'mobile', ), ), 'extends' => array ( 'widget' => 'standard/input/SmartAssistantDialog', 'components' => array ( 'php' => true, ), 'overrideViewAndLogic' => true, ), 'relativePath' => 'custom/input/CustomSmartAssist', 'extends_info' => array ( 'controller' => array ( 0 => 'standard/input/SmartAssistantDialog', ), 'view' => array ( ), 'logic' => array ( ), 'js_templates' => array ( ), 'base_css' => array ( ), 'presentation_css' => array ( ), 'parent' => 'standard/input/SmartAssistantDialog', ), 'widget_name' => 'CustomSmartAssist', 'extends_php' => array ( 0 => 'standard/input/SmartAssistantDialog', ), 'parent' => 'standard/input/SmartAssistantDialog', ), );
$result['meta']['attributes'] = array( 'get_answer_content' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '/ci/ajaxRequest/getAnswer', 'type' => 'AJAX', 'default' => '/ci/ajaxRequest/getAnswer', 'inherited' => true, )), 'label_banner' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(3303), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(3303), 'inherited' => true, )), 'label_prompt' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(1984), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(1984), 'inherited' => true, )), 'label_no_results' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(42065), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(42065), 'inherited' => true, )), 'label_submit_button' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(4781), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(4781), 'inherited' => true, )), 'label_cancel_button' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(1699), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(1699), 'inherited' => true, )), 'label_solved_button' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(2783), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(2783), 'inherited' => true, )), 'label_dialog_title' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(1967), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(1967), 'inherited' => true, )), 'label_collapsed' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(14422), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(14422), 'inherited' => true, )), 'label_expanded' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(14416), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(14416), 'inherited' => true, )), 'label_accesskey' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(19076), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(19076), 'inherited' => true, )), 'label_download_attachment' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(40397), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(40397), 'inherited' => true, )), 'label_view_guide' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => \RightNow\Utils\Config::getMessage(47429), 'type' => 'STRING', 'default' => \RightNow\Utils\Config::getMessage(47429), 'inherited' => true, )), 'solved_url' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '/app/' . \RightNow\Utils\Config::getConfig((226)), 'type' => 'STRING', 'default' => '/app/' . \RightNow\Utils\Config::getConfig((226)), 'inherited' => true, )), 'accesskeys_enabled' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => true, 'type' => 'BOOLEAN', 'default' => true, 'inherited' => true, )), 'display_answers_inline' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => true, 'type' => 'BOOLEAN', 'default' => true, 'inherited' => true, )), 'button_ordering' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => 'label_solved_button, label_submit_button, label_cancel_button', 'type' => 'STRING', 'default' => 'label_solved_button, label_submit_button, label_cancel_button', 'inherited' => true, )), 'display_button_as_link' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => 'label_cancel_button', 'type' => 'STRING', 'default' => 'label_cancel_button', 'inherited' => true, )), 'dialog_width' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '800px', 'type' => 'STRING', 'default' => '800px', 'inherited' => true, )), 'dnc_label_cancel_button' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '', 'type' => 'STRING', 'default' => '', 'inherited' => true, )), 'dnc_label_banner' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '', 'type' => 'STRING', 'default' => '', 'inherited' => true, )), 'dnc_label_dialog_title' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '', 'type' => 'STRING', 'default' => '', 'inherited' => true, )), 'dnc_redirect_url' => \RightNow\Libraries\Widget\Attribute::__set_state(array( 'value' => '', 'type' => 'STRING', 'default' => '', 'inherited' => true, )), );
return $result;
}
